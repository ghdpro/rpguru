{% extends "base.html" %}
{% load core markdownify %}

{% block head_title %}{{ object.name }}{% endblock %}

{% block content %}
    <div class="d-flex flex-wrap">
        <h1>{{ object.name }}</h1>
        {% if user.is_superuser %}
        <div class="align-self-center d-block ml-auto">
            <a class="btn btn-sm btn-outline-secondary" href="{% get_absolute_url object view.model|meta:'model_name'|concat:':update' %}"><i class="fas fa-pencil-alt fa-fw"></i> Edit</a>
            <a class="btn btn-sm btn-outline-secondary ml-2" href="{% get_absolute_url object view.model|meta:'model_name'|concat:':artwork' %}"><i class="fas fa-file-image fa-fw"></i> Artwork</a>
        </div>
        {% endif %}
    </div>
    {{ object.description|markdownify }}

    {% if view.model|meta:'model_name' == 'franchise' and main|length > 0 or side|length > 0 %}
        {% if main|length > 0 %}
            <h3 class="text-center">Main Games</h3>
            {% for game in main %}
                {% include 'library/_game.html' with game=game perms=perms only %}
            {% endfor %}
        {% endif %}

        {% if side|length > 0 %}
            <h3 class="text-center">Side Games</h3>
            {% for game in side%}
                {% include 'library/_game.html' with game=game perms=perms only %}
            {% endfor %}
        {% endif %}
    {% elif view.model|meta:'model_name' == 'company' and developed|length > 0 or published|length > 0 %}
        {% if developed|length > 0 %}
            <h3 class="text-center">Games developed by {{ company.name }}</h3>
            {% for game in developed %}
                {% include 'library/_game.html' with game=game perms=perms only %}
            {% endfor %}
        {% endif %}

        {% if published|length > 0 %}
            <h3 class="text-center">Games published by {{ company.name }}</h3>
            {% for game in published %}
                {% include 'library/_game.html' with game=game perms=perms only %}
            {% endfor %}
            <p class="text-center"><i>To keep the size of this page down, this section doesn't include games where {{ company.name }} was also the developer of the game.</i></p>
        {% endif %}
    {% else %}
        {% for game in games %}
            {% include 'library/_game.html' with game=game perms=perms only %}
        {% endfor %}
    {% endif %}
{% endblock content %}